{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.2", "generated_at": "2025-10-22T22:24:01.082006Z", "invocation_id": "70180ec8-ef7e-4373-b2c8-3f13961394a4", "invocation_started_at": "2025-10-22T22:23:59.532199Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-22T22:24:00.535793Z", "completed_at": "2025-10-22T22:24:00.542810Z"}, {"name": "execute", "started_at": "2025-10-22T22:24:00.542810Z", "completed_at": "2025-10-22T22:24:00.661116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12783193588256836, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enterate.stg_electricity", "compiled": true, "compiled_code": "-- i-DE (electricidad) => columnas esperadas por el modelo com\u00fan\nselect\n  md5(concat_ws('||',\n      'ide','electricity', coalesce(municipio,''), coalesce(via,''), coalesce(numero,''),\n      (to_timestamp(fecha||' '||hora_inicio,'DD/MM/YYYY HH24:MI') at time zone 'Europe/Madrid')::text,\n      (to_timestamp(fecha||' '||hora_fin   ,'DD/MM/YYYY HH24:MI') at time zone 'Europe/Madrid')::text\n  ))                                           as fingerprint,\n  'ide'                                        as source,\n  'electricity'                                as category,\n  'planned'                                    as status,\n  municipio                                    as city,\n  via                                          as street,\n  nullif(numero,'')                            as street_number,\n  lat::double precision                        as lat,\n  lon::double precision                        as lon,\n  (to_timestamp(fecha||' '||hora_inicio,'DD/MM/YYYY HH24:MI') at time zone 'Europe/Madrid') as start_ts_utc,\n  (to_timestamp(fecha||' '||hora_fin   ,'DD/MM/YYYY HH24:MI') at time zone 'Europe/Madrid') as end_ts_utc,\n  null::text                                   as description,\n  null::text                                   as event_id,\n  now() at time zone 'utc'                     as ingested_at_utc\nfrom \"appdb\".\"staging\".\"electricity\"", "relation_name": "\"appdb\".\"analytics_staging\".\"stg_electricity\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-22T22:24:00.669637Z", "completed_at": "2025-10-22T22:24:00.672412Z"}, {"name": "execute", "started_at": "2025-10-22T22:24:00.673409Z", "completed_at": "2025-10-22T22:24:00.734203Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06554865837097168, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enterate.stg_gas", "compiled": true, "compiled_code": "-- Gas simulado -> normaliza a modelo com\u00fan\nselect\n  md5(concat_ws('||',\n      'gas','gas',\n      coalesce(direccion,''),\n      coalesce(nullif(start_ts,''),''),\n      coalesce(nullif(end_ts,''),'')\n  ))                                             as fingerprint,\n  'gas'                                          as source,\n  'gas'                                          as category,\n  case\n    when coalesce(nullif(lower(programado::text),''),'false')\n         in ('true','t','1','yes','y','si','s\u00ed') then 'planned'\n    else 'unplanned'\n  end                                            as status,\n  'Madrid'                                       as city,\n  direccion                                      as street,\n  null::text                                     as street_number,\n  lat::double precision                          as lat,\n  lon::double precision                          as lon,\n  nullif(start_ts,'')::timestamptz               as start_ts_utc,\n  nullif(end_ts,'')::timestamptz                 as end_ts_utc,\n  mensaje                                        as description,\n  event_id::text                                 as event_id,\n  now() at time zone 'utc'                       as ingested_at_utc\nfrom \"appdb\".\"staging\".\"gas\"", "relation_name": "\"appdb\".\"analytics_staging\".\"stg_gas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-22T22:24:00.737203Z", "completed_at": "2025-10-22T22:24:00.740224Z"}, {"name": "execute", "started_at": "2025-10-22T22:24:00.740224Z", "completed_at": "2025-10-22T22:24:00.796836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05963325500488281, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enterate.stg_road", "compiled": true, "compiled_code": "-- Ayuntamiento (tr\u00e1fico/obras)\nselect\n  md5(concat_ws('||',\n      'ayto',\n      case when coalesce(es_obras,false) then 'road_works'\n           when coalesce(es_accidente,false) then 'accident'\n           else 'road' end,\n      coalesce(municipio,''), coalesce(coalesce(via,descripcion,''),''), coalesce(numero,''),\n      coalesce(nullif(start_ts,''),'') , coalesce(nullif(end_ts,''),'')\n  ))                                           as fingerprint,\n  'ayto'                                       as source,\n  case when coalesce(es_obras,false) then 'road_works'\n       when coalesce(es_accidente,false) then 'accident'\n       else 'road' end                         as category,\n  case when nullif(estado,'') = '1' then 'active' else 'planned' end      as status,\n  municipio                                    as city,\n  coalesce(via, descripcion)                   as street,\n  nullif(numero,'')                            as street_number,\n  lat::double precision                        as lat,\n  lon::double precision                        as lon,\n  nullif(start_ts,'')::timestamptz             as start_ts_utc,\n  nullif(end_ts,'')::timestamptz               as end_ts_utc,\n  descripcion                                  as description,\n  coalesce(id_incidencia::text, event_id::text) as event_id,\n  now() at time zone 'utc'                     as ingested_at_utc\nfrom \"appdb\".\"staging\".\"road\"", "relation_name": "\"appdb\".\"analytics_staging\".\"stg_road\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-22T22:24:00.799834Z", "completed_at": "2025-10-22T22:24:00.802850Z"}, {"name": "execute", "started_at": "2025-10-22T22:24:00.802850Z", "completed_at": "2025-10-22T22:24:00.919024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12018942832946777, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enterate.stg_water", "compiled": true, "compiled_code": "-- Canal de Isabel II (agua) -> normaliza a modelo com\u00fan\nselect\n  md5(concat_ws('||',\n      'canal','water',\n      coalesce(direccion,''),\n      coalesce(nullif(start_ts,''),''),\n      coalesce(nullif(end_ts,''),'')\n  ))                                             as fingerprint,\n  'canal'                                        as source,\n  'water'                                        as category,\n  case\n    when coalesce(nullif(lower(programado::text),''),'false')\n         in ('true','t','1','yes','y','si','s\u00ed') then 'planned'\n    else 'unplanned'\n  end                                            as status,\n  'Madrid'                                       as city,\n  direccion                                      as street,\n  null::text                                     as street_number,\n  lat::double precision                          as lat,\n  lon::double precision                          as lon,\n  nullif(start_ts,'')::timestamptz               as start_ts_utc,\n  nullif(end_ts,'')::timestamptz                 as end_ts_utc,\n  mensaje                                        as description,\n  event_id::text                                 as event_id,\n  now() at time zone 'utc'                       as ingested_at_utc\nfrom \"appdb\".\"staging\".\"water\"", "relation_name": "\"appdb\".\"analytics_staging\".\"stg_water\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-22T22:24:00.923023Z", "completed_at": "2025-10-22T22:24:00.934540Z"}, {"name": "execute", "started_at": "2025-10-22T22:24:00.935541Z", "completed_at": "2025-10-22T22:24:01.056552Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13454914093017578, "adapter_response": {"_message": "INSERT 0 180", "code": "INSERT", "rows_affected": 180}, "message": "INSERT 0 180", "failures": null, "unique_id": "model.enterate.fct_events", "compiled": true, "compiled_code": "\n\nwith unioned as (\n  select * from \"appdb\".\"analytics_staging\".\"stg_electricity\"\n  union all\n  select * from \"appdb\".\"analytics_staging\".\"stg_water\"\n  union all\n  select * from \"appdb\".\"analytics_staging\".\"stg_road\"\n  union all\n  select * from \"appdb\".\"analytics_staging\".\"stg_gas\"\n)\n\nselect * from unioned\n\n\nwhere ingested_at_utc >\n  (select coalesce(max(ingested_at_utc),'1970-01-01T00:00:00Z') from \"appdb\".\"analytics_analytics\".\"fct_events\")\n", "relation_name": "\"appdb\".\"analytics_analytics\".\"fct_events\"", "batch_results": null}], "elapsed_time": 0.767448902130127, "args": {"require_all_warnings_handled_by_warn_error": false, "log_format_file": "debug", "profiles_dir": "C:\\Users\\diego\\.dbt", "populate_cache": true, "macro_debugging": false, "printer_width": 80, "export_saved_queries": false, "write_json": true, "state_modified_compare_more_unrendered_values": false, "require_batched_execution_for_custom_microbatch_strategy": false, "vars": {}, "exclude": [], "show": false, "log_level_file": "debug", "show_resource_report": false, "require_nested_cumulative_type_params": false, "use_fast_test_edges": false, "defer": false, "version_check": true, "send_anonymous_usage_stats": true, "state_modified_compare_vars": false, "partial_parse": true, "show_all_deprecations": false, "indirect_selection": "eager", "warn_error_options": {"error": [], "warn": [], "silence": []}, "source_freshness_run_project_hooks": true, "require_resource_names_without_spaces": true, "log_path": "C:\\Users\\diego\\Documents\\Diego\\Master\\TFM\\Enterate\\etl\\warehouse\\dbt\\logs", "partial_parse_file_diff": true, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "use_colors_file": true, "favor_state": false, "log_file_max_bytes": 10485760, "upload_to_artifacts_ingest_api": false, "include_saved_query": false, "resource_types": [], "validate_macro_args": false, "exclude_resource_types": [], "project_dir": "C:\\Users\\diego\\Documents\\Diego\\Master\\TFM\\Enterate\\etl\\warehouse\\dbt", "empty": false, "quiet": false, "select": [], "skip_nodes_if_on_run_start_fails": false, "cache_selected_only": false, "introspect": true, "use_colors": true, "which": "build", "log_format": "default", "log_level": "info", "static_parser": true, "invocation_command": "dbt build --project-dir C:\\Users\\diego\\Documents\\Diego\\Master\\TFM\\Enterate\\etl\\warehouse\\dbt", "strict_mode": false, "require_yaml_configuration_for_mf_time_spines": false}}