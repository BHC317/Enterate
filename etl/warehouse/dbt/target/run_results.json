{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.2", "generated_at": "2025-10-20T22:38:39.260521Z", "invocation_id": "11464d60-df6a-430d-adeb-ad877110857c", "invocation_started_at": "2025-10-20T22:38:37.673729Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T22:38:38.778622Z", "completed_at": "2025-10-20T22:38:38.785271Z"}, {"name": "execute", "started_at": "2025-10-20T22:38:38.786252Z", "completed_at": "2025-10-20T22:38:38.898094Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11947178840637207, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enterate.stg_electricity", "compiled": true, "compiled_code": "-- i-DE (electricidad) => columnas esperadas por el modelo com\u00fan\nselect\n  md5(concat_ws('||',\n      'ide','electricity', coalesce(municipio,''), coalesce(via,''), coalesce(numero,''),\n      (to_timestamp(fecha||' '||hora_inicio,'DD/MM/YYYY HH24:MI') at time zone 'Europe/Madrid')::text,\n      (to_timestamp(fecha||' '||hora_fin   ,'DD/MM/YYYY HH24:MI') at time zone 'Europe/Madrid')::text\n  ))                                           as fingerprint,\n  'ide'                                        as source,\n  'electricity'                                as category,\n  'planned'                                    as status,\n  municipio                                    as city,\n  via                                          as street,\n  nullif(numero,'')                            as street_number,\n  lat::double precision                        as lat,\n  lon::double precision                        as lon,\n  (to_timestamp(fecha||' '||hora_inicio,'DD/MM/YYYY HH24:MI') at time zone 'Europe/Madrid') as start_ts_utc,\n  (to_timestamp(fecha||' '||hora_fin   ,'DD/MM/YYYY HH24:MI') at time zone 'Europe/Madrid') as end_ts_utc,\n  null::text                                   as description,\n  null::text                                   as event_id,\n  now() at time zone 'utc'                     as ingested_at_utc\nfrom \"appdb\".\"staging\".\"electricity\"", "relation_name": "\"appdb\".\"analytics_staging\".\"stg_electricity\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T22:38:38.903032Z", "completed_at": "2025-10-20T22:38:38.905601Z"}, {"name": "execute", "started_at": "2025-10-20T22:38:38.905601Z", "completed_at": "2025-10-20T22:38:38.949256Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04816436767578125, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enterate.stg_gas", "compiled": true, "compiled_code": "-- Gas simulado -> normaliza a modelo com\u00fan\nselect\n  md5(concat_ws('||',\n      'gas','gas',\n      coalesce(direccion,''),\n      coalesce(nullif(start_ts,''),''),\n      coalesce(nullif(end_ts,''),'')\n  ))                                             as fingerprint,\n  'gas'                                          as source,\n  'gas'                                          as category,\n  case\n    when coalesce(nullif(lower(programado::text),''),'false')\n         in ('true','t','1','yes','y','si','s\u00ed') then 'planned'\n    else 'unplanned'\n  end                                            as status,\n  'Madrid'                                       as city,\n  direccion                                      as street,\n  null::text                                     as street_number,\n  lat::double precision                          as lat,\n  lon::double precision                          as lon,\n  nullif(start_ts,'')::timestamptz               as start_ts_utc,\n  nullif(end_ts,'')::timestamptz                 as end_ts_utc,\n  mensaje                                        as description,\n  event_id::text                                 as event_id,\n  now() at time zone 'utc'                       as ingested_at_utc\nfrom \"appdb\".\"staging\".\"gas\"", "relation_name": "\"appdb\".\"analytics_staging\".\"stg_gas\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T22:38:38.952799Z", "completed_at": "2025-10-20T22:38:38.956054Z"}, {"name": "execute", "started_at": "2025-10-20T22:38:38.956054Z", "completed_at": "2025-10-20T22:38:39.019562Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06676340103149414, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enterate.stg_road", "compiled": true, "compiled_code": "-- Ayuntamiento (tr\u00e1fico/obras)\nselect\n  md5(concat_ws('||',\n      'ayto',\n      case when coalesce(es_obras,false) then 'road_works'\n           when coalesce(es_accidente,false) then 'accident'\n           else 'road' end,\n      coalesce(municipio,''), coalesce(coalesce(via,descripcion,''),''), coalesce(numero,''),\n      coalesce(nullif(start_ts,''),'') , coalesce(nullif(end_ts,''),'')\n  ))                                           as fingerprint,\n  'ayto'                                       as source,\n  case when coalesce(es_obras,false) then 'road_works'\n       when coalesce(es_accidente,false) then 'accident'\n       else 'road' end                         as category,\n  case when nullif(estado,'') = '1' then 'active' else 'planned' end      as status,\n  municipio                                    as city,\n  coalesce(via, descripcion)                   as street,\n  nullif(numero,'')                            as street_number,\n  lat::double precision                        as lat,\n  lon::double precision                        as lon,\n  nullif(start_ts,'')::timestamptz             as start_ts_utc,\n  nullif(end_ts,'')::timestamptz               as end_ts_utc,\n  descripcion                                  as description,\n  coalesce(id_incidencia::text, event_id::text) as event_id,\n  now() at time zone 'utc'                     as ingested_at_utc\nfrom \"appdb\".\"staging\".\"road\"", "relation_name": "\"appdb\".\"analytics_staging\".\"stg_road\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T22:38:39.023052Z", "completed_at": "2025-10-20T22:38:39.025112Z"}, {"name": "execute", "started_at": "2025-10-20T22:38:39.026118Z", "completed_at": "2025-10-20T22:38:39.121426Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10143661499023438, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.enterate.stg_water", "compiled": true, "compiled_code": "-- Canal de Isabel II (agua) -> normaliza a modelo com\u00fan\nselect\n  md5(concat_ws('||',\n      'canal','water',\n      coalesce(direccion,''),\n      coalesce(nullif(start_ts,''),''),\n      coalesce(nullif(end_ts,''),'')\n  ))                                             as fingerprint,\n  'canal'                                        as source,\n  'water'                                        as category,\n  case\n    when coalesce(nullif(lower(programado::text),''),'false')\n         in ('true','t','1','yes','y','si','s\u00ed') then 'planned'\n    else 'unplanned'\n  end                                            as status,\n  'Madrid'                                       as city,\n  direccion                                      as street,\n  null::text                                     as street_number,\n  lat::double precision                          as lat,\n  lon::double precision                          as lon,\n  nullif(start_ts,'')::timestamptz               as start_ts_utc,\n  nullif(end_ts,'')::timestamptz                 as end_ts_utc,\n  mensaje                                        as description,\n  event_id::text                                 as event_id,\n  now() at time zone 'utc'                       as ingested_at_utc\nfrom \"appdb\".\"staging\".\"water\"", "relation_name": "\"appdb\".\"analytics_staging\".\"stg_water\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T22:38:39.126021Z", "completed_at": "2025-10-20T22:38:39.135058Z"}, {"name": "execute", "started_at": "2025-10-20T22:38:39.135379Z", "completed_at": "2025-10-20T22:38:39.242982Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11696028709411621, "adapter_response": {"_message": "INSERT 0 262", "code": "INSERT", "rows_affected": 262}, "message": "INSERT 0 262", "failures": null, "unique_id": "model.enterate.fct_events", "compiled": true, "compiled_code": "\n\nwith unioned as (\n  select * from \"appdb\".\"analytics_staging\".\"stg_electricity\"\n  union all\n  select * from \"appdb\".\"analytics_staging\".\"stg_water\"\n  union all\n  select * from \"appdb\".\"analytics_staging\".\"stg_road\"\n  union all\n  select * from \"appdb\".\"analytics_staging\".\"stg_gas\"\n)\n\nselect * from unioned\n\n\nwhere ingested_at_utc >\n  (select coalesce(max(ingested_at_utc),'1970-01-01T00:00:00Z') from \"appdb\".\"analytics_analytics\".\"fct_events\")\n", "relation_name": "\"appdb\".\"analytics_analytics\".\"fct_events\"", "batch_results": null}], "elapsed_time": 0.652064323425293, "args": {"use_colors_file": true, "send_anonymous_usage_stats": true, "cache_selected_only": false, "invocation_command": "dbt build --project-dir etl/warehouse/dbt", "select": [], "project_dir": "etl/warehouse/dbt", "defer": false, "require_nested_cumulative_type_params": false, "quiet": false, "require_yaml_configuration_for_mf_time_spines": false, "partial_parse_file_diff": true, "profiles_dir": "C:\\Users\\diego\\.dbt", "print": true, "log_format_file": "debug", "favor_state": false, "introspect": true, "empty": false, "use_colors": true, "use_fast_test_edges": false, "indirect_selection": "eager", "require_all_warnings_handled_by_warn_error": false, "include_saved_query": false, "show": false, "vars": {}, "write_json": true, "source_freshness_run_project_hooks": true, "printer_width": 80, "populate_cache": true, "resource_types": [], "exclude": [], "log_format": "default", "log_file_max_bytes": 10485760, "log_path": "etl\\warehouse\\dbt\\logs", "exclude_resource_types": [], "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "state_modified_compare_more_unrendered_values": false, "show_all_deprecations": false, "show_resource_report": false, "log_level": "info", "state_modified_compare_vars": false, "upload_to_artifacts_ingest_api": false, "version_check": true, "require_resource_names_without_spaces": true, "macro_debugging": false, "which": "build", "require_batched_execution_for_custom_microbatch_strategy": false, "strict_mode": false, "skip_nodes_if_on_run_start_fails": false, "validate_macro_args": false, "export_saved_queries": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "partial_parse": true}}